# Malware detection using FFT and Neural Networks

# Preprocessing of dataset
We will be using [**Microsoft Malware Classification Challenge (BIG 2015)**](https://www.kaggle.com/competitions/malware-classification/data). Firstly we have to remove memory addresses from .bytes files. After that we will take segments of 128 bits of hexadecimal data, calculate FFT on them and then average them all for the whole file. In dataset we have 9 classes of malware, the FFT from files of each class looks like this:
![alt text](https://github.com/marcinele/ml-malware-detection/blob/marcinele/img/fft.png?raw=true)

# Neural Network
For classification we will build and train the following neural network:

```
model = tf.keras.Sequential()
model.add(tf.keras.layers.Dense(1024, activation='relu', input_shape=(input_size,)))
model.add(tf.keras.layers.Dropout(0.1))
model.add(tf.keras.layers.Dense(2048, activation='relu'))
model.add(tf.keras.layers.Dropout(0.1)) 
model.add(tf.keras.layers.Dense(1024, activation='relu'))
model.add(tf.keras.layers.Dense(num_classes+1, activation='softmax'))

model.summary()
model.compile(loss='categorical_crossentropy', optimizer=tf.keras.optimizers.Adam(), metrics=['accuracy'])
```

After training with following setting:
```
conf_dict = {
  "Machine" : "HPEnvy15x360",
  "CPU" : "AMD Ryzen 4700U",
  "batch-size" : 32,
  "epochs" : 50,
}

history = model.fit(x_train, y_train, batch_size=conf_dict['batch-size'], epochs=conf_dict['epochs'], verbose=1, validation_split=0.5,  
                    callbacks=WandbCallback())
```

We got our results:
![alt text](https://github.com/marcinele/ml-malware-detection/blob/marcinele/img/accur_graph.png?raw=true)
The best epoch was 43 with 93% of accuracy of classification.
