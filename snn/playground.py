import numpy as np
import re
import os
import pandas as pd
from tqdm import tqdm
import matplotlib.pyplot as plt

f = open('../dataset/kaggle/0A32eTdBKayjCWhZqDOQ.bytes', 'r')

SIZE = 128

res = [0]*SIZE
lines = f.readlines()
lines = [l.replace('?', '0') for l in lines]
current = []
with tqdm(total=len(lines), desc='Convert to fft: ') as bar:
  for line in lines:
    line = re.sub('^[0-9A-F]{8}', '', line)
    pure_hex = line.strip().split(' ')
    current += pure_hex
    if len(current) >= SIZE:
      
      pure_ints = [int(hex, 16) for hex in current]

      fft_res = np.fft.fft(pure_ints, norm='backward')
      fft_res_abs = [np.abs(c) for c in fft_res]
      while len(fft_res_abs) < SIZE:
        fft_res_abs.append(0)
      res = np.add(res, fft_res_abs)
      #print(res)
      #sys.stdin.read(1)
      current = []
    bar.update(1)

res = np.true_divide(res, len(lines))
res = np.true_divide(res, max(res))
fig = plt.figure()
print(len(res))
plt.plot(res, '*')
plt.show()



final_data = [res]