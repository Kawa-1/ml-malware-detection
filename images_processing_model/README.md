# Malware detection -> processing files as images

### Overview
That model is based on the transforming bytes of every malicious file
into image, and then processed by the Neural Convolutional Network. <br>
README contains the description of the methods that were used in data preparation process
and the Keras model itself.

### Data preparation scripts
Data preparation scripts can be found in the data_preparation folder. 
Initial dataset was collected from the [**Microsoft Malware Classification Challenge (BIG 2015)**](https://www.kaggle.com/competitions/malware-classification/data) <br>
It contains 10,868 .bytes files of the malicious files and the .csv file that indicates which file belongs to which 
malware type. It total, there are 9 malware types:
* Ramnit
* Lollipop
* Kelihos_ver3
* Vundo
* Simda
* Tracur
* Kelihos_ver1
* Obfuscator.ACY
* Gatak
<br>
The whole process consists of the 4 steps:
1. Removing the redundant information from the dataset. <br>
[removing_metadata.py](https://github.com/marcinele/ml-malware-detection/blob/main/images_processing_model/data_preparation/removing_metadata.py) <br>
In order to transform the bytes into the .png file, metadata is not needed, so it was deleted.
2. Transforming hex values into the decimals -> [hex_into_decimal.py](https://github.com/marcinele/ml-malware-detection/blob/main/images_processing_model/data_preparation/hex_into_decimal.py) <br>
Initial .bytes files consisted of 17 values lines - memory address and 16 hexadecimal numbers. <br>
Sample file looked like that: <br> <br>
![alt text](https://github.com/marcinele/ml-malware-detection/blob/main/images_processing_model/README_images/sample_bytes_file.png) <br> <br>
hex_into_decimal.py trims the address from each line, and then transform the values into the decimals. <br>
Sample result: <br> <br>
![alt text](https://github.com/marcinele/ml-malware-detection/blob/main/images_processing_model/README_images/sample_converted_file.png) <br> <br>
3. Transforming the raw decimal files into the .png images -> [hex_into_decimal.py](https://github.com/marcinele/ml-malware-detection/blob/main/images_processing_model/data_preparation/decimal_into_images.py) <br>
Beside the transition, that script also resizes the images, so the every image is 128 x 128. The function *resize* from the OpenCV module was used. 
Sample outputs of that step are as follows: <br> <br>
![alt text](https://github.com/marcinele/ml-malware-detection/blob/main/images_processing_model/README_images/sample_malware_as_images.png) <br> <br>
4. Diving the files into the classes -> [hex_into_decimal.py](https://github.com/marcinele/ml-malware-detection/blob/main/images_processing_model/data_preparation/dividing_set.py) <br>
That script simply assigns the images into the corresponding class number folder.
### Keras model
