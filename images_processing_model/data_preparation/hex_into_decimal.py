import os

from images_processing_model.data_preparation.paths import STARTING_FOLDER_PATH, DECIMAL_FOLDER_PATH

directory_path = STARTING_FOLDER_PATH
directory_output = DECIMAL_FOLDER_PATH

directory = os.fsencode(directory_path)

i = 0
for file in os.listdir(directory):
    filename = os.fsdecode(file)
    if filename.endswith(".bytes"):
        f = open(directory_output + "/" + filename, "w")
        with open(directory_path + "/" + filename) as topo_file:
            for line in topo_file:
                elements = line.split()
                elements = elements[1:len(elements)]
                string_to_write = ""
                for element in elements:
                    if element != "??":
                        string_to_write = string_to_write + str(int(element, 16)) + " "
                    else:
                        string_to_write = string_to_write + "0 "
                string_to_write = string_to_write[:-1] + "\n"
                f.write(string_to_write)
        f.close()
        i += 1
        percentage = i / (len(os.listdir(directory)))
        print(f"File: {filename} finished. {percentage * 100} % done")